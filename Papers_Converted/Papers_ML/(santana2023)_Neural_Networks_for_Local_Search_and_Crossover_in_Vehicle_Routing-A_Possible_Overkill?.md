1

## Neural Networks for Local Search and Crossover in Vehicle Routing: A Possible Overkill?

´ talo Santana , Andrea Lodi , Thibaut Vidal I 1 2 1,3

Department of Computer Science, Pontifical Catholic University of Rio de Janeiro

2 Jacobs Technion-Cornell Institute, Cornell Tech and Technion - IIT

3 CIRRELT &amp; SCALE-AI Chair in Data-Driven Supply Chains, Department of Mathematical and Industrial Engineering, Polytechnique Montr´ eal

isantana@inf.puc-rio.br, andrea.lodi@cornell.edu, thibaut.vidal@polymtl.ca

## Abstract

Extensive research has been conducted, over recent years, on various ways of enhancing heuristic search for combinatorial optimization problems with machine learning algorithms. In this study, we investigate the use of predictions from graph neural networks (GNNs) in the form of heatmaps to improve the Hybrid Genetic Search (HGS), a state-of-the-art algorithm for the Capacitated Vehicle Routing Problem (CVRP). The crossover and local-search components of HGS are instrumental in finding improved solutions, yet these components essentially rely on simple greedy or random choices. It seems intuitive to attempt to incorporate additional knowledge at these levels. Throughout a vast experimental campaign on more than 10,000 problem instances, we show that exploiting more sophisticated strategies using measures of node relatedness (heatmaps, or simply distance) within these algorithmic components can significantly enhance performance. However, contrary to initial expectations, we also observed that heatmaps did not present significant advantages over simpler distance measures for these purposes. Therefore, we faced a common -though rarely documented- situation of overkill: GNNs can indeed improve performance on an important optimization task, but an ablation analysis demonstrated that simpler alternatives perform equally well.

## 1 Introduction

Vehicle routing problems (VRP) represent one of the most studied classes of NP-hard problems due to their practical difficulty and ubiquity in real-life applications such as food distribution, parcel delivery, or waste collection, among others (Toth and Vigo 2014; Vidal, Laporte, and Matl 2020). Problems in this class generally seek to plan efficient itineraries for a fleet of vehicles to service a geographically-dispersed set of customers. The capacitated VRP (CVRP) is the most canonical variant among all existing routing problems. Its objective is to minimize the total distance traveled by the vehicles to service the customers, subject to a single constraint representing the vehicle capacities: i.e., the sum of customers' demands over a route should not exceed the vehicle capacity.

Over the years, there have been dramatic improvements in the heuristic and exact (i.e., provably optimal) solution of VRPs. To date, the best performing exact algorithms rely on branch-cut-and-price strategies, with tailored cuttingplane algorithms and sophisticated column-generation routines (Costa, Contardo, and Desaulniers 2019; Pessoa et al.

2020). With these methods, it is now possible to solve most existing instances with 200 or 300 customers. However, the time for an exact solution remains highly volatile at this scale, and most larger instances remain unsolved. Consequently, extensive research has been conducted on metaheuristics for this problem to find high-quality solutions in a shorter and more controlled time (Vidal et al. 2013a).

As it stands now, metaheuristics can consistently locate high-quality solutions for CVRPs with up to 1,000 customers in a matter of minutes (Christiaens and Vanden Berghe 2020; Vidal 2022). Of all existing methods, the Hybrid Genetic Search (HGS) algorithm developed in Vidal et al. (2012, 2014) and (Vidal 2022) is known to achieve the best-known solution quality consistently on most problems and instances of interest. Notably, during the 12th DIMACS implementation challenge on the CVRP organized in 2022 (Archetti et al. 2022), it was used as the base algorithm for four out of the five best methods. Very-large problem instances counting dozens of thousands of customers can also be solved using tailored data structures and decomposition strategies (Accorsi and Vigo 2021; Santini et al. 2021). Considering the latest generation of metaheuristics such as HGS, it is clear that two main operators -local search and crossover- are instrumental in finding improving solutions.

- · Local Search (LS) consists in systematically exploring a neighborhood obtained by small changes over a current solution to identify improvements. This process is iterated until attaining a local minimum. Classical neighborhoods for the CVRP involve exchanges or relocations of client visits and edge reconnections. They typically include O ( n 2 ) possible neighbors, where n represents the number of customers. Due to its iterative nature, LS typically takes the largest share of the computational time. Several techniques have been developed to reduce computational complexity. In particular, Toth and Vigo (2003) observed that the search could be limited to relocations and exchanges of customers that are geographically related . The resulting strategy, called granular search, limits classical neighborhoods to O (Γ n ) moves, where Γ is a user-defined parameter. However, although very simple in design, a straightforward distance-based relatedness criterion may hinder the search process, especially if optimal solutions require a few long edges.
- · In contrast, Crossover operators focus on diversifying

the search. They consist of recombining two existing (parent) solutions into a new (offspring) solution that inherits promising characteristics from both. For the CVRP, crossover operators are not primarily designed for solution improvement, but instead used to create promising starting points for subsequent LS. Various crossovers have been used in previous works (Nagata 2007; Vidal 2022). As shown in Section 2, the Ordered Crossover (OX) is widely used, and consists in juxtaposing a fragment of the first solution with the remaining client visits ordered as in the second solution. By doing so, it implicitly creates a re-connection point, which is typically random.

Note that in both LS and Crossover, there is interest in using relatedness information between client vertices to (i) speed up the LS or (ii) identify a subset of more promising crossover operations. It is also noteworthy that the relatedness information used until now for the LS (and possibly used for the crossover) is a broader concept that goes beyond simple distance criteria, and which could be possibly learned.

In recent years, graph neural networks (GNNs) have emerged as a tool to apply machine learning techniques to combinatorial optimization problems posed over graphs. To the best of our knowledge, the first attempt in this context was proposed by Hopfield and Tank (1985) for the TSP. Underpinned by enhancements in hardware and artificial intelligence research over the last years, the development of deep NNs made them relevant to a wide range of difficult combinatorial optimization problems, such as SAT, Minimum Vertex Cover, and Maximum Cut (Dai et al. 2017; Yolcu and P´ oczos 2019). When applied to solve CVRPs, these networks are usually combined with reinforcement learning (RL - Nazari et al. 2018; Chen and Tian 2019) or typically used for node classification or edge prediction (Kool et al. 2022; Xin et al. 2021). Despite extensive research, GNNs for directly solving CVRPs remain limited to small problem instances with up to 100 customers and generally do not compare favorably with classic optimization methods (exact or heuristic) in terms of solution quality. This is possibly due to the fact that good solutions for combinatorial optimization problems result from tacit structural knowledge about the problem (learnable solution structure) along with a significant amount of trial-and-error to build the best possible solution fitting almost perfectly the constraints at hand. After all, an optimal solution is a very specific outlier. Whereas better knowledge of solution structures can be learned to guide the search, avoiding some (explicit or implicit) enumeration of solutions without compromising solution quality is generally challenging. Consequently, using pure learning algorithms without any other form of solution enumeration is likely to be unsuccessful.

Given these observations, a promising path toward better solution methods for VRPs concern the hybridization of learning-based and traditional solution methods. In this work, in particular, we aim to learn and use relatedness information in the LS and crossover operators of HGS to improve this state-of-the-art method substantially. We capitalize upon the work of Kool et al. (2022), which trained a GNN to predict occurrence probabilities of edges in high-quality solutions (i.e., heatmap), and used this information to sparsify the un- derlying graph and accelerate related solution procedures. Instead, we leverage the heatmaps as a source of relatedness information to define neighborhood restrictions in the LS and possible re-connection points in the crossover. Throughout an extensive experimental campaign, we evaluate how HGS' performance varies with these surgical changes, for better or worse, on more than 10000 different instances containing from 100 to 1000 customers. Therefore, we make the following specific contributions.

- 1. We introduce a framework for defining and exploiting relatedness information between pairs of customers in the context of the CVRP.
- 2. We show that relatedness measures can be exploited to steer the LS towards the most promising moves. Additionally, we use relatedness information to extend the classical OXcrossover, trading some of its inherent randomness for better choices of re-connection points between the parents. Our approaches are generic and applicable to any type of relatedness measure. We will specifically consider relatedness from two sources: geographical relatedness as given by the distance between two customers, and learnable relatedness (i.e., heatmap) obtained from a GNN.
- 3. We suggest a practical technique to exploit the output of a single GNN (heatmaps for fixed-size graphs) for problem instances of varying sizes. To achieve this, we decompose the original instance into a sequence of fixed-size subproblems and aggregate the resulting heatmap information. This approach has the benefit of only requiring a single trained model of moderate size.
- 4. Finally, we conduct an extensive computational campaign to measure the enhancements achieved with the proposed techniques and analyze the impact of each change. We observe that incorporating relatedness information within the crossover and LS operators largely benefit the search, such that learning-based approaches seem to be successful at first sight. However, after a closer analysis, we also observe that these improvements are mostly insensitive to the source of the relatedness information (geographical or learned). Therefore, the problem-specific knowledge and strategies that we integrated contributed more to the algorithm's performance than GNN-based algorithms for defining relatedness.

## 2 Methodology

The CVRP is defined over a complete graph G = ( V, E ) , where the set of vertices V = { 0 1 , . . . , n } contains a vertex 0 representing the depot, and the remaining vertices represent customers. Each customer i ∈ { 1 , . . . , n } is characterized by a demand d i . Edges ( i, j ) model direct travel between vertices i and j for a distance d ij . A solution to this problem is a set of routes originating and ending at the depot and visiting customers, such that (i) the total demand over each route does not exceed a vehicle-capacity limit Q , (ii) each customer is visited exactly once, and (iii) the total travel distance is minimized.

We additionally assume that we can calculate a relatedness metric φ i, j ( ) for each edge ( i, j ) . This definition is general: in the simplest setting, relatedness could be the inverse of distance, i.e., φ i, j ( ) = 1 /d ij . In a more informed setting, we can instead consider defining φ i, j ( ) as the output of a graph neural network (GNN) as seen in Kool et al. (2022), predicting the probability of occurrence of an edge in a highquality solution. Probabilities of this kind are typically called heatmaps. In the remainder of the paper, we will refer to φ D ( i, j ) for distance-relatedness, and φ N ( i, j ) for GNN-based relatedness. This information will now be used to refine the two most important HGS operators.

## 2.1 Hybrid Genetic Search

The Hybrid Genetic Search (Vidal 2022) relies on simple solution generation and improvement steps. A complete pseudocode is provided in the appendix. The method starts by initializing a population of size µ with random solutions that are improved by local search. After this initialization phase, HGS iteratively generates new solutions by selecting two random solutions in the population, recombining them using an ordered crossover (OX), and applying local search for improvement. To promote exploration, solutions that exceed capacity limits are not directly rejected but instead penalized according to their amount of infeasibility. The penalty weights are adapted during the search to achieve a target percentage of feasible solutions, and infeasible solutions are maintained in a separate subpopulation. Whenever a solution is infeasible after local search, an extra REPAIR step is applied, which simply consists of a classic local search with a temporarily ( 10 × ) higher penalty coefficient.

During the overall search process, the number of solutions in the feasible and infeasible populations is monitored. Whenever any population exceeds µ + λ solutions, a survivors' selection phase is triggered to retain only the best µ individuals, according to a ranking metric based on solution value and contribution to the population diversity. Finally, the algorithm restarts each time n IT consecutive solution generations have been done without improvement of the best solution, and it terminates upon a time limit T MAX by returning the best solution found over all the restarts.

## 2.2 Local Search using Relatedness Measures

Local Search (LS) is a conceptually simple and efficient method to solve combinatorial optimization problems of the form min x ∈ X c x ( ) , where X is the space of all solutions and c is the objective function. A neighborhood is defined as a mapping N : X → 2 X associating with any solution x a set of neighbors N ( x ) ⊂ X . For the CVRP, N ( x ) is usually defined relative to a set of operations (i.e., moves) that can modify the current solution x . A move τ is a small modification that can be applied on x to obtain a neighbor τ ( x ) ∈ N ( x ) . HGS uses four main types of moves and some of their immediate extensions (Vidal 2022):

- · RELOCATE: Moves a visit to customer i immediately after a visit to a different customer j or the depot;
- · SWAP: Exchanges the visits of customers i and j ;
- · 2-OPT: Reverts a customer-visit sequence ( i, . . . , j ) ;
- · 2-OPT*: Exchanges customers i and j and their succeeding visits.

The moves are evaluated in a random order of the indices i and j , and any improvement is directly applied. This process is repeated until a local minimum is reached, i.e., a

Twenty customers most related to customer 63 according to φ D and φ N :

Customer 63 in an optimal solution:

![Image](image_000000_bdce52c1669a269fce7d4b51681c6f37886ee79eaa747957fbc6d0ad15735b2d.png)

Figure 1: Sets of related customers according to φ D and φ N , on instance X-n247-k50

![Image](image_000001_b9e8720857f77ff415e9ba869e104ecfab57180f9ef3c5f8278a23f9ba96aa8b.png)

Depot situation where no improving move exists for all the considered neighborhoods. Without further pruning, all these neighborhoods contain O n ( 2 ) solutions. Using incremental calculations (keeping track of partial load and distance over the routes), it is possible to conduct a complete evaluation of all neighborhoods in O n ( 2 ) time. Moreover, the number of complete neighborhood searches (i.e., loops) needed to converge is rarely greater than 10 in practice.

A quadratic complexity for the LS operator is adequate for small problems, but this can become a significant bottleneck otherwise due to its frequent use. Considering this, Toth and Vigo (2003) introduced a 'granular search' mechanism that consists in limiting the moves to customer pairs ( i, j ) that are geographically close, i.e., such that j belongs to a set Φ( ) i formed of the Γ closest customers of i . Consequently, the total number of moves and the complexity of each LS loop reduce down to O n ( Γ) time. Indeed, it rarely makes sense to relocate or exchange customer visits that are far away from each other. Moreover, this strategy ensures that each move creates at least one short edge (Schneider, Schwahn, and Vigo 2017; Vidal et al. 2013b; Accorsi and Vigo 2021).

Since its inception, granular search has been adapted to many VRP variants. Especially, to handle customer constraints on service-time windows, (Vidal et al. 2013b) extended the concept to filter node pairs ( i, j ) based on a compound metric that includes distance, unavoidable waiting times, and unavoidable time-window violations arising from

Figure 2: Illustration of the ordered crossover (OX)

![Image](image_000002_0511417093279133e53d30d5b6f4e6ef38bcfd8739b1ba8f6fec4098f1ba6d91.png)

this customer succession.

In this study, we instead extend the filtering criterion by relying on relatedness information from the GNN. As illustrated in Figure 1 for instance X-n247-k50 from Uchoa et al. (2017), the Γ most-related customers according to the relatedness metrics φ D and φ N can differ very significantly. In this particular example, the GNN-based relatedness even includes an edge (in boldface) contained in the optimal solution that is otherwise missing when considering distance only.

For each i , we therefore form the set Φ( ) i in two steps: we first include in Φ( ) i the glyph[floorleft] Γ 2 / glyph[floorright] vertices that are most related to i according to the GNN-based relatedness metric φ N ( i, j ) , and then we complete the glyph[ceilingleft] Γ 2 / glyph[ceilingright] remaining customers by increasing distance, therefore according to φ D ( i, j ) . This strategy uses learned information and ensures that the Γ 2 / closest customers are still considered in the moves.

## 2.3 Crossover using Relatedness Measures

In HGS, each solution is represented as a single permutation of the customer's visits (i.e., a giant tour) during the crossover operation. This use of this simple representation is motivated by the fact that (i) one can simply represent any complete solution by concatenating the routes and omitting the visits to the depot, and (ii) reversely, given a sequence of customers visits, there exists a linear-time algorithm, called SPLIT, that optimally segments this giant tour into routes (Vidal 2016).

Based on this representation, HGS employs the ordered crossover (OX - Oliver, Smith, and Holland 1987) illustrated in Figure 2. OX works in two steps. First, a fragment F of the first parent defined by two randomly-selected cutting points is copied in place into an empty offspring. Next, the second parent is scanned from the position of the second cutting point to complete all missing customer visits circularly. This gives a new giant tour, which is then transformed into a complete CVRP solution using SPLIT.

As it stands, OX is completely dependent upon random choices. In particular, the second step tends to concatenate unrelated customers immediately after fragment F . This creates low-quality fragments of solution requiring many LS moves for improvement. To correct this issue, we suggest relying on the relatedness metric to modify the completion step. Let i be the last customer from fragment F . Instead of arbitrarily reconnecting F with the next customer from Parent 2 obtained by a circular sweep, we select a random related customer j among the Γ customers most related to i that are not part of F (or a random position if no such j exists) and then proceed to complete the offspring from this position following the order in Parent 2. This small but notable difference permits reconnecting visits that are more closely related among both parents, allowing for better solutions without sacrificing diversity. As previously, the choice of relatedness metric leads to different variants of the OX crossover. An illustrative example of such re-connection is presented in the appendix. In the remainder of this paper, we will refer to the modified crossover using distance-relatedness as DOX, and to the modified crossover using GNN-relatedness as NOX.

## 3 Experimental Analyses

This section presents extensive computational experiments designed to: (i) calibrate and evaluate the impact of the granular search parameter Γ , which governs the size of the LS neighborhoods; (ii) measure the impact of our enhancements on the LS and OX operators as well as the usefulness of different relatedness criteria; (iii) confront the characteristics, the computational effort, and the performance of heatmaps produced by different GNN configurations, and (iv) analyze the extension of GNNs originally trained on fixed-size graphs to instances of varying sizes. We address objective (i) in Section 3.4, whereas objectives (ii, iii, iv) are covered in Sections 3.5 and 3.6.

Wewill analyze, in the following sections, the performance of HGS in its original form (baseline) along with five combinations of φ D and φ N for local search and crossover operators, which are listed below:

- · HGS-D-O (baseline) : HGS with granular search and OX;
- · HGS-D-D : HGS with granular search and DOX;
- · HGS-D-N : HGS with granular search and NOX;
- · HGS-N-O : HGS with neural granular search and OX;
- · HGS-N-D : HGS with neural granular search and DOX;
- · HGS-N-N : HGS with neural granular search and NOX.

## 3.1 Computational Environment

All experiments are run on a single thread of an Intel Gold 6148 Skylake 2.4 GHz processor with 40 GB of RAM and NVIDIA Tesla P100 Pascal (12 G memory), running CentOS7.8.2003. Unless otherwise stated, we use the original parameters defined for HGS in Vidal (2022) and the GNN in Kool et al. (2022). To achieve fast convergence, we set smaller values for the population-size parameters in HGS: µ = 12 and λ = 20 . We compile HGS with g++ 9.1.0 and execute the GNN using Python 3.8.8 on Torch 1.9.1.

## 3.2 Benchmark Instances

Our experiments use two main sets of CVRP instances: Set X from Uchoa et al. (2017), and Set XML from Queiroga et al. (2022). Set X is a well-known benchmark of 100 instances containing between 100 and 1000 customers. This set includes very diverse instances that mimic important characteristics of real-world situations concerning depot positions, route length, customer demands, and locations. The XML set (Queiroga et al. 2022) includes 10,000 instances of 100 customers each, drawn from a similar distribution as set X. One advantage of the XML set is that the number of customers is constant in all instances, and all optimal solutions are provided. This permits comparisons with proven optima instead of best-known solutions (BKS) collected from all previous works. In contrast, many instances of set X are still unsolved to proven optimality. All instance sets, open-source codes, and scripts needed to run the experiments are provided at [released-upon-final-publication].

## 3.3 Parametrization and Training of the GNN

The GNN proposed by Kool et al. (2022) is designed to be trained and applied for prediction over graphs (i.e., instances) of fixed size. The authors provided the final model trained on instances containing 100 customers, which can therefore be directly applied for inference on the XML instances. In contrast, Set X has instances with different numbers of customers, such that a different approach is needed to use the heatmaps. Due to these key differences, we will subdivide the presentation of our experiments into two parts, with results on XML instances in Section 3.5, and adaptations and results for Set X in Section 3.6.

In these experiments, we use the original trained GNN from Kool et al. (2022) for heatmap generation, called ORIGINAL in the rest of this paper. However, even though this model is already trained, it takes around 0 85 . seconds of inference time to produce the heatmap for a given instance. This is a similar order of magnitude as the time needed by HGS to solve the CVRP to near optimality (i.e., below 0 1% . error) on instances containing 100 customers. Since we aim to compare CVRP solution algorithms under the same total CPU time budget (counting inference time and solution time), GNN-based methods would be at a disadvantage if a large share of the CPU time is invested in the inference step. Therefore, to estimate the performance of GNN-based algorithms in the most optimistic conditions (e.g., considering a hypothetical scenario where GPU inference is extremely fast), we will also report the results of the same method ignoring inference time. Additionally, we produce results (counting inference time) obtained with two lighter versions of the GNN, called MODEL #1 and MODEL #2, which were trained on the same examples as Kool et al. (2022), with fewer internal nodes and internal layers. Table 1 summarizes the parameter setting of all the considered GNNs.

Table 1: GNN configurations

| GNN        |   #NODES |   #LAYERS |   #EPOCHS | PRED-T(S)   |
|------------|----------|-----------|-----------|-------------|
| ORIGINAL   |      300 |        30 |      1500 | 0.85        |
| OPTIMISTIC |      300 |        30 |      1500 | IGNORED     |
| MODEL #1   |       10 |         5 |       500 | 0.03        |
| MODEL #2   |       10 |         5 |      1500 | 0.03        |

This table lists for each GNN the number of hidden layers (# LAYERS), nodes per layer (# NODES), and epochs

(# EPOCHS) used for training. Finally, the last column reports the average inference time on an XML instance. The parameters of MODEL #1 and MODEL #2 were selected to achieve training and inference in a limited time. MODEL #1 (resp. #2) required 8 (resp. 24) hours of training time on our hardware.

## 3.4 Calibration of the Local Search

We focus here on the parameter Γ , which drives the exploration breadth of the LS (see Section 2.2) and significantly impacts the computational time of HGS. The aim of this experiment is to select a meaningful range of values for this parameter. Based on standard values used in previous works, we evaluate configurations Γ ∈ { 5 10 15 20 30 50 100 , , , , , , } and analyze the sensitivity of the baseline method (i.e., HGSD-O) to this parameter. To keep a simple experimental design, we focus on the performance of the LS by generating ten random initial solutions for each instance and applying a single LS to each of these solutions. We then report in Table 2 the quality of the best solution found as well as the computational time used by the ten LS runs.

Table 2: Impact of Γ on solution quality and CPU time

|     | SET X   | SET X    | SET XML   | SET XML   |
|-----|---------|----------|-----------|-----------|
| Γ   | GAP%    | TIME (S) | GAP%      | TIME (S)  |
| 5   | 4.664   | 0.157    | 2.976     | 0.024     |
| 10  | 4.018   | 0.160    | 2.365     | 0.026     |
| 15  | 3.817   | 0.162    | 2.194     | 0.027     |
| 20  | 3.667   | 0.165    | 2.137     | 0.029     |
| 30  | 3.630   | 0.197    | 2.087     | 0.034     |
| 50  | 3.696   | 0.238    | 2.089     | 0.043     |
| 100 | 3.690   | 0.375    | 2.087     | 0.057     |

In Table 2 and the rest of this paper, solution quality is expressed as a percentage error gap calculated as GAP(%) = 100 × ( z -z BKS ) /z BKS , where z represents the cost of the solution and z BKS is the optimal or BKS cost value.

The results of this experiment indicate that solution quality generally improves with Γ , but with decreasing marginal returns. We cease to see notable solution quality improvements once Γ exceeds a value of 30 , but CPU time dramatically increases. Given this, we set Γ = 15 in the remainder of our experiments, and additionally provide detailed results with Γ ∈ { 20 30 50 , , } in the appendix.

## 3.5 Experimental Results - Set XML

Having calibrated all the algorithmic components, we can now measure the impact of GNN-informed relatedness measures in the LS and crossover operator. We focus here on the instances of set XML. Given that HGS converges towards near-optimal solutions within seconds for these instances, we use a short termination criterion with T MAX = 5 seconds per instance and report final results as well as convergence plots to measure the impact of the different versions of the LS and crossover.

Table 3 therefore reports the number of optimal solutions (#OPT) attained over the 10,000 instances and the average final GAP(%) for all of the methods, considering the four possible GNN configurations (ORIGINAL, OPTIMISTIC, MODEL #1, and MODEL #2). Best performance is indicated in boldface. Additionally, the convergence plots of Figure 3 depict the progress of the average gap of the different methods over time for the OPTIMISTIC configuration of the GNN, and similar graphs are provided for the other GNN configurations in the appendix.

Figure 3: Convergence plots for all HGS variants on set XML (upper graph = complete run, lower graph = last 1.5 seconds)

![Image](image_000003_cf7067c139ee1cdc2ca53b86520842345d1086fbbb2f0b903bf5246fc70a292a.png)

As seen in these results, all HGS versions progress (i.e., decrease the gap) smoothly within the time limit, and all approaches except HGS-N-O outperformed HGS-D-O (the baseline HGS algorithm) in terms of their number of optimal solutions and average gap. The significance of these improvements is confirmed by two-tailed paired-samples Wilcoxon tests between each method and HGS-D-O at a significance level of 0.05.

However, these experiments also show that HGS-N-O does not perform significantly better than HGS-D-O, even when ignoring the inference time (i.e., OPTIMISTIC evaluation of the GNN). This indicates that using the GNN-based relatedness criterion in the LS does not bring significant benefits. It is an open research question to determine if different GNN architectures may perform better in the task of filtering LS neighborhoods.

Now, a comparison of configurations HGS-D-O (baseline), HGS-D-D, and HGS-D-N permits us to assess the impact of our changes on the crossover operator. We remind that HGS-D-O refers to the original OX crossover, whereas HGSD-D and HGS-D-N modify the reconnection step to integrate relatedness information. As seen in our experiments, HGS-DDand HGS-D-N are much better than the baseline (final gaps of 0 024% . compared to 0 030% . ), as confirmed by pairedsamples Wilcoxon tests at 0 05 . significance level. This is a notable breakthrough, given that it is uncommon to identify simple conceptual changes to HGS that significantly improve its state-of-the-art performance.

Finally, the choice of configuration for the GNN did not significantly affect the results, and our observations remain valid for the ORIGINAL, MODEL #1, and MODEL #2 configurations.

## 3.6 Experimental Results - Set X

The instances of set X include a different number of customers, but the GNN of Kool et al. (2022) is designed to predict heatmaps only for fixed-size graphs. Moreover, training a model on an instance of maximal size (1000 customers) and relying on dummy nodes is likely to require extensive training time (especially with its original parametrization).

To circumvent this issue, we instead propose to combine the heatmaps from different subproblems to obtain a relatedness measure for all customers. Let n G be the graph size handled by the GNN. For each customer i ∈ { 1 , . . . , n } , in turn, we collect the n G -1 closest customers along with the depot to form a CVRP subproblem with exactly n G customers. We rely on the GNN to infer the heatmap for this graph, and use the heatmap values for all edges ( i, j ) such that j belongs to the subproblem and 0 otherwise. This simple approach requires n heatmaps inference steps, but the inherent parallelism of Pytorch makes it effective enough for our purposes.

As previously, we report the results of the different HGS variants in Table 4 for the four considered GNN parameter settings. We set a total computational time budget that is linearly proportional to n , allowing 24 seconds for the smallest instance (X-n101-k25) with 100 customers, and up to 240 seconds for the largest one (X-n1001-k43) with 1000 customers. Moreover, we perform 10 experiments with different random seeds for each of the 100 instances, leading to 1000 solution processes. The table, therefore, counts the number of optimal solutions out of 1000 as well as the average error gap when the algorithm terminates. With these time limits, the inference time of the ORIGINAL GNN represents 15.2% of the overall time budget, and the inference time of MODEL #1 and MODEL #2 is limited to 1.9% of the time budget. Convergence plots in the same format as before are additionally presented in Figure 4.

These additional results on Set X confirm our previous observations: all HGS variants except HGS-N-O outperformed the HGS-D-O baseline. Additionally, the proposed modifications to the crossover operator (HGS-D-D and HGS-D-N) led to performance improvements that are even more expressive on that instance set, with final gaps of 0 302% . and 0 299% . compared to 0 368% . for the original HGS. As previously, however, using learned information from the GNN instead of distance did not make a substantial difference in the crossover and even appeared to be detrimental in the context of the LS.

It is important to stress that, without a complete analysis involving HGS-D-D, a comparison of HGS-D-N versus HGS-

Table 3: Results of all methods and GNN configurations for the instances of set XML

|            | HGS-D-O   | HGS-D-O   | HGS-D-D   | HGS-D-D   | HGS-D-N   | HGS-D-N   | HGS-N-O   | HGS-N-O   | HGS-N-D   | HGS-N-D   | HGS-N-N   | HGS-N-N   |
|------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| GNN        | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      |
| ORIGINAL   | 7715      | 0.030     | 8105      | 0.024     | 8086      | 0.023     | 7691      | 0.031     | 8046      | 0.023     | 8011      | 0.025     |
| OPTIMISTIC | 7715      | 0.030     | 8105      | 0.024     | 8120      | 0.023     | 7732      | 0.031     | 8062      | 0.023     | 8041      | 0.025     |
| MODEL #1   | 7715      | 0.030     | 8105      | 0.024     | 8094      | 0.023     | 7697      | 0.031     | 8028      | 0.024     | 7994      | 0.025     |
| MODEL #2   | 7715      | 0.030     | 8105      | 0.024     | 8102      | 0.024     | 7719      | 0.030     | 8067      | 0.024     | 8057      | 0.024     |

Table 4: Results of all methods and GNN configurations for the instances of set X

|            | HGS-D-O   | HGS-D-O   | HGS-D-D   | HGS-D-D   | HGS-D-N   | HGS-D-N   | HGS-N-O   | HGS-N-O   | HGS-N-D   | HGS-N-D   | HGS-N-N   | HGS-N-N   |
|------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| GNN        | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      | #OPT      | GAP%      |
| ORIGINAL   | 188       | 0.368     | 187       | 0.302     | 184       | 0.317     | 177       | 0.395     | 169       | 0.325     | 172       | 0.317     |
| OPTIMISTIC | 188       | 0.368     | 187       | 0.302     | 187       | 0.299     | 185       | 0.365     | 177       | 0.307     | 182       | 0.299     |
| MODEL #1   | 188       | 0.368     | 187       | 0.302     | 185       | 0.309     | 166       | 0.414     | 177       | 0.332     | 184       | 0.336     |
| MODEL #2   | 188       | 0.368     | 187       | 0.302     | 186       | 0.301     | 169       | 0.391     | 175       | 0.314     | 170       | 0.316     |

![Image](image_000004_d1d845dd6ee44f201c461a4daace69619a2052626fbd078021b22b147dbf6e30.png)

## 4 Conclusions

Figure 4: Convergence plots for all HGS variants on set X

![Image](image_000005_b27f4702f10f4c5bec42f9bb50476a698964051eb4b1fc04d511fa46c59a7302.png)

D-O could have led to the conclusion that the GNN was responsible for the improvement. However, recommending the use of this method in this context would have been an 'overkill' since a simpler reconnection mechanism based on distance effectively produces the same gains.

In this work, we have shown that relatedness metrics can be broadly used to improve the performance of the HGS (Vidal 2022), a state-of-the-art solution algorithm for the CVRP. Relatedness has been exploited in two ways: to focus the LS on promising moves, and to steer the crossover operator towards meaningful reconnections. As relatedness is a fairly general concept, we can freely use geographical or learnable (i.e., GNN-based) information for that purpose. As seen in our experimental analyses, these adaptations lead to significant improvements on a large benchmark counting over 10,000 instances. Additionally, we show that a simple strategy to extend GNN heatmap predictions to instances of varying size is fairly effective, circumventing the limitation due to fixed-size training. Overall, exploiting heatmaps to boost HGS operators is very effective, but also not superior to a simpler application of distance-based relatedness for similar purposes. This observation contrasts with the superiority claims of sophisticated learning mechanisms and ever-larger networks. Instead, it aligns with the 'less-is-more' approach toward algorithmic design.

We acknowledge that some aspects studied in this work can be further investigated for future research. The first one refers to the applications of relatedness criteria to other combinatorial optimization problems and solvers (e.g., branch and bound). Another research avenue of interest concerns exploiting different relatedness sources and simpler machine learning models. Finally, from a more general viewpoint, we expect that the contributions of this work can lead to a better comprehension of the challenges involved in incorporating sophisticated machine learning techniques into state-of-the-art solvers. We believe that research on GNN-enhanced heuristics is promising, but that careful ablation studies are essential to correctly measure impacts and improvements.

## Acknowledgements

This research was enabled in part by support provided by Calcul Qu´ ebec, Compute Canada, and CAPES-PROEX [grant number 88887.214468/2018-00]. This support is gratefully acknowledged.

## References

Accorsi, L.; and Vigo, D. 2021. A fast and scalable heuristic for the solution of large-scale capacitated vehicle routing problems. Transportation Science , 55(4): 832-856.

Archetti, C.; Kullman, N.; McGeoch, C.; Mendoza, J.; Pardalos, P.; Resende, M.; Uchoa, E.; and Vidal, T. 2022. 12th DIMACS challenge. http://dimacs.rutgers.edu/programs/ challenge/vrp/. Accessed: 2022-06-06.

Chen, X.; and Tian, Y. 2019. Learning to perform local rewriting for combinatorial optimization. In Advances in Neural Information Processing Systems , volume 32, 62786289.

Christiaens, J.; and Vanden Berghe, G. 2020. Slack induction by string removals for vehicle routing problems. Transportation Science , 54(2): 417-433.

Costa, L.; Contardo, C.; and Desaulniers, G. 2019. Exact branch-price-and-cut algorithms for vehicle routing. Transportation Science , 53(4): 946-985.

Dai, H.; Khalil, E. B.; Zhang, Y.; Dilkina, B.; and Song, L. 2017. Learning combinatorial optimization algorithms over graphs. In Proceedings of the 31st International Conference on Neural Information Processing Systems , 6351-6361. Red Hook, NY, USA: Curran Associates Inc.

Hopfield, J. J.; and Tank, D. W. 1985. 'Neural' computation of decisions in optimization problems. Biological Cybernetics , 52(3): 141-152.

Kool, W.; van Hoof, H.; Gromicho, J.; and Welling, M. 2022. Deep policy dynamic programming for vehicle routing problems. In Schaus, P., ed., Integration of Constraint Programming, Artificial Intelligence, and Operations Research , 190213. Cham: Springer International Publishing.

Nagata, Y. 2007. Edge assembly crossover for the capacitated vehicle routing problem. Lecture Notes in Computer Science , 4446: 142-153.

Nazari, M.; Oroojlooy, A.; Tak´ aˇ, M.; and Snyder, L. V . 2018. c Reinforcement learning for solving the vehicle routing problem. In Proceedings of the 32nd International Conference on Neural Information Processing Systems , 9861-9871.

Oliver, I. M.; Smith, D. J.; and Holland, J. R. C. 1987. A study of permutation crossover operators on the traveling salesman problem. In Proceedings of the Second International Conference on Genetic Algorithms on Genetic algorithms and their application , 224-230.

Pessoa, A.; Sadykov, R.; Uchoa, E.; and Vanderbeck, F. 2020. A generic exact solver for vehicle routing and related problems. Mathematical Programming , 183(1): 483-523.

Queiroga, E.; Sadykov, R.; Uchoa, E.; and Vidal, T. 2022. 10,000 optimal CVRP solutions for testing machine learning based heuristics. In AAAI-22 Workshop on Machine Learning for Operations Research (ML4OR) .

Santini, A.; Schneider, M.; Vidal, T.; and Vigo, D. 2021. Decomposition strategies for vehicle routing heuristics. Technical report, Universitat Pompeu Fabra.

Schneider, M.; Schwahn, F.; and Vigo, D. 2017. Designing granular solution methods for routing problems with time windows. European Journal of Operational Research , 263(2): 493-509.

Toth, P.; and Vigo, D. 2003. The granular tabu search and its application to the vehicle-routing problem. INFORMS Journal on Computing , 15(4): 333-346.

Toth, P.; and Vigo, D., eds. 2014. Vehicle Routing: Problems, Methods, and Applications . Philadelphia: Society for Industrial and Applied Mathematics, 2nd edition.

Uchoa, E.; Pecin, D.; Pessoa, A.; Poggi, M.; Vidal, T.; and Subramanian, A. 2017. New benchmark instances for the capacitated vehicle routing problem. European Journal of Operational Research , 257(3): 845-858.

Vidal, T. 2016. Split algorithm in O(n) for the capacitated vehicle routing problem. Computers &amp; Operations Research , 69: 40-47.

Vidal, T. 2022. Hybrid genetic search for the CVRP: Opensource implementation and SWAP* neighborhood. Computers &amp; Operations Research , 140: 105643.

Vidal, T.; Crainic, T.; Gendreau, M.; Lahrichi, N.; and Rei, W. 2012. A hybrid genetic algorithm for multidepot and periodic vehicle routing problems. Operations Research , 60(3): 611-624.

Vidal, T.; Crainic, T.; Gendreau, M.; and Prins, C. 2013a. Heuristics for multi-attribute vehicle routing problems: A survey and synthesis. European Journal of Operational Research , 231(1): 1-21.

Vidal, T.; Crainic, T.; Gendreau, M.; and Prins, C. 2014. A unified solution framework for multi-attribute vehicle routing problems. European Journal of Operational Research , 234(3): 658-673.

Vidal, T.; Crainic, T. G.; Gendreau, M.; and Prins, C. 2013b. A hybrid genetic algorithm with adaptive diversity management for a large class of vehicle routing problems with timewindows. Computers and Operations Research , 40(1): 475489.

Vidal, T.; Laporte, G.; and Matl, P. 2020. A concise guide to existing and emerging vehicle routing problem variants. European Journal of Operational Research , 286: 401-416.

Xin, L.; Song, W.; Cao, Z.; and Zhang, J. 2021. NeuroLKH: Combining deep learning model with Lin-KernighanHelsgaun heuristic for solving the traveling salesman problem. In Advances in Neural Information Processing Systems , volume 34.

Yolcu, E.; and P´czos, B. 2019. Learning local search heuriso tics for boolean satisfiability. In Wallach, H.; Larochelle, H.; Beygelzimer, A.; d'Alch´ e-Buc, F.; Fox, E.; and Garnett, R., eds., Advances in Neural Information Processing Systems , volume 32. Curran Associates, Inc.

## A Pseudo-code of the Hybrid Genetic Search (HGS)

Algorithm 1 provides the pseudo-code of HGS for the CVRP, as originally proposed in Vidal (2022) and described in Section 2.1 of the main paper.

Algorithm 1: Hybrid Genetic Search for the CVRP (HGS) 1: Initialize population with random solutions improved by local search 2: while time &lt; T max do 3: Select parent solutions P 1 and P 2 4: Apply the crossover operator on P 1 and P 2 to generate an offspring C 5: Educate offspring C by local search 6: Insert C into respective subpopulation 7: if C is infeasible then 8: With 50% probability, repair C (local search) and 9: insert it into respective subpopulation 10: end if 11: if maximum subpopulation size reached then 12: Select survivors 13: end if 14: Adjust penalty coefficients for infeasibility 15: end while 16: Return best feasible solution

## B Illustration of the NOX and DOX Operators

Figure 5 illustrates the use of relatedness measures within OX, as discussed in Section 2.3. In this example, which is valid for both NOX and DOX, the algorithm selects fragment F = [9 1 10 7] , , , from Parent 1. With this, i = 7 is the last element of F (Step #1). Then, it proceeds to select a random related customer among the Γ most-related customers of i that are not part of F . We assume, in this example, that this customer is j = 8 . Finally, it completes the offspring from this position, following the order in Parent 2 (Step #2).

Figure 5: Illustration of the crossover using relatedness measures (NOX and DOX)

![Image](image_000006_0a8d7aa925696a9d74151bd74a95bc339012e35837d55739edfdda32906bfec4.png)

## C Detailed Experimental Results - Set XML

Table 5 provides additional detailed results, covering all values of Γ ∈ { 15 20 30 50 , , , } on all XML instances of Queiroga et al. (2022). It reports the number of optimal solutions (#OPT) attained over the 10,000 XML instances and the average final GAP(%), calculated as GAP(%) = 100 × ( z -z BKS ) /z BKS , where z represents the cost of the solution and z BKS is the optimal or

BKS cost value. The results are provided for all of the methods, considering the four possible GNN configurations (ORIGINAL, OPTIMISTIC, MODEL #1, and MODEL #2). The best performance in each row is highlighted in boldface.

Additionally, Figure 6 provides convergence plots for all possible GNN configurations. The graphs included in it represent the progress of the average gap over time, considering the parameter value Γ = 15 . On these graphs, it is noteworthy that the ORIGINAL configuration of the GNN requires significant inference time to generate the heatmap before the optimization can start. In comparison, MODEL #1 and MODEL #2 start much faster and behave quite similarly to the OPTIMISTIC curve that ignores inference time.

Next, Figure 7 presents boxplots of the percentage error gaps of the methods for different subsets of the XML instances, using the ORIGINAL configuration of the GNN and Γ = 15 . Indeed, as discussed in Uchoa et al. (2017) and Queiroga et al. (2022), the instances were designed to mimic important features present in real-world problems, with different conventions regarding depot position, customers position, demand distribution, and average route size. Therefore, each boxplot corresponds to a subset of the instances with a specific configuration for one of these parameters. In these boxplots, the boxes indicate the first and third quartile, and the whiskers extend to 1 5 . times the interquartile range.

Table 5: Results for set XML for all values of Γ ∈ { 15 20 30 50 , , , }

|                                                                                  | HGS-D-O                                                                          | HGS-D-O                                                                          | HGS-D-D                                                                          | HGS-D-D                                                                          | HGS-D-N                                                                          | HGS-D-N                                                                          | HGS-N-O                                                                          | HGS-N-O                                                                          | HGS-N-D                                                                          | HGS-N-D                                                                          | HGS-N-N                                                                          | HGS-N-N                                                                          |
|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| GNN                                                                              | #OPT                                                                             | GAP%                                                                             | #OPT                                                                             | GAP%                                                                             | #OPT                                                                             | GAP%                                                                             | #OPT                                                                             | GAP%                                                                             | #OPT                                                                             | GAP%                                                                             | #OPT                                                                             | GAP%                                                                             |
| ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = 0.85)      |
| 15                                                                               | 7715                                                                             | 0.030                                                                            | 8105                                                                             | 0.024                                                                            | 8086                                                                             | 0.023                                                                            | 7691                                                                             | 0.031                                                                            | 8046                                                                             | 0.023                                                                            | 8011                                                                             | 0.025                                                                            |
| 20                                                                               | 7612                                                                             | 0.032                                                                            | 7969                                                                             | 0.025                                                                            | 7932                                                                             | 0.026                                                                            | 7482                                                                             | 0.035                                                                            | 7903                                                                             | 0.027                                                                            | 7811                                                                             | 0.028                                                                            |
| 30                                                                               | 7181                                                                             | 0.041                                                                            | 7590                                                                             | 0.031                                                                            | 7544                                                                             | 0.032                                                                            | 7054                                                                             | 0.044                                                                            | 7466                                                                             | 0.034                                                                            | 7419                                                                             | 0.036                                                                            |
| 50                                                                               | 6421                                                                             | 0.063                                                                            | 6804                                                                             | 0.050                                                                            | 6775                                                                             | 0.052                                                                            | 6365                                                                             | 0.067                                                                            | 6674                                                                             | 0.055                                                                            | 6684                                                                             | 0.055                                                                            |
| AVG                                                                              | 7232.3                                                                           | 0.042                                                                            | 7617.0                                                                           | 0.033                                                                            | 7584.3                                                                           | 0.033                                                                            | 7148.0                                                                           | 0.044                                                                            | 7522.3                                                                           | 0.035                                                                            | 7481.3                                                                           | 0.036                                                                            |
| OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 30; #EPOCHS: 1500; PRED-T(S) = IGNORED) |
| 15                                                                               | 7715                                                                             | 0.030                                                                            | 8105                                                                             | 0.024                                                                            | 8120                                                                             | 0.023                                                                            | 7732                                                                             | 0.031                                                                            | 8062                                                                             | 0.023                                                                            | 8041                                                                             | 0.025                                                                            |
| 20                                                                               | 7612                                                                             | 0.032                                                                            | 7969                                                                             | 0.025                                                                            | 7956                                                                             | 0.026                                                                            | 7515                                                                             | 0.034                                                                            | 7942                                                                             | 0.026                                                                            | 7814                                                                             | 0.028                                                                            |
| 30                                                                               | 7181                                                                             | 0.041                                                                            | 7590                                                                             | 0.031                                                                            | 7591                                                                             | 0.031                                                                            | 7102                                                                             | 0.044                                                                            | 7517                                                                             | 0.033                                                                            | 7465                                                                             | 0.035                                                                            |
| 50                                                                               | 6421                                                                             | 0.063                                                                            | 6804                                                                             | 0.050                                                                            | 6830                                                                             | 0.052                                                                            | 6427                                                                             | 0.066                                                                            | 6718                                                                             | 0.054                                                                            | 6748                                                                             | 0.054                                                                            |
| AVG                                                                              | 7232.3                                                                           | 0.042                                                                            | 7617.0                                                                           | 0.033                                                                            | 7624.3                                                                           | 0.033                                                                            | 7194.0                                                                           | 0.044                                                                            | 7559.8                                                                           | 0.034                                                                            | 7517.0                                                                           | 0.036                                                                            |
| MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 0.03)         |
| 15                                                                               | 7715                                                                             | 0.030                                                                            | 8105                                                                             | 0.024                                                                            | 8094                                                                             | 0.023                                                                            | 7697                                                                             | 0.031                                                                            | 8028                                                                             | 0.024                                                                            | 7994                                                                             | 0.025                                                                            |
| 20                                                                               | 7612                                                                             | 0.032                                                                            | 7969                                                                             | 0.025                                                                            | 7941                                                                             | 0.025                                                                            | 7450                                                                             | 0.034                                                                            | 7822                                                                             | 0.027                                                                            | 7865                                                                             | 0.027                                                                            |
| 30                                                                               | 7181                                                                             | 0.041                                                                            | 7590                                                                             | 0.031                                                                            | 7524                                                                             | 0.032                                                                            | 7068                                                                             | 0.044                                                                            | 7464                                                                             | 0.034                                                                            | 7384                                                                             | 0.036                                                                            |
| 50                                                                               | 6421                                                                             | 0.063                                                                            | 6804                                                                             | 0.050                                                                            | 6815                                                                             | 0.051                                                                            | 6379                                                                             | 0.066                                                                            | 6709                                                                             | 0.056                                                                            | 6715                                                                             | 0.055                                                                            |
| AVG                                                                              | 7232.3                                                                           | 0.042                                                                            | 7617.0                                                                           | 0.033                                                                            | 7593.5                                                                           | 0.033                                                                            | 7148.5                                                                           | 0.044                                                                            | 7505.8                                                                           | 0.035                                                                            | 7489.5                                                                           | 0.036                                                                            |
| MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 0.03)        |
| 15                                                                               | 7715                                                                             | 0.030                                                                            | 8105                                                                             | 0.024                                                                            | 8102                                                                             | 0.024                                                                            | 7719                                                                             | 0.030                                                                            | 8067                                                                             | 0.024                                                                            | 8057                                                                             | 0.024                                                                            |
| 20                                                                               | 7612                                                                             | 0.032                                                                            | 7969                                                                             | 0.025                                                                            | 7954                                                                             | 0.025                                                                            | 7577                                                                             | 0.033                                                                            | 7845                                                                             | 0.027                                                                            | 7900                                                                             | 0.026                                                                            |
| 30                                                                               | 7181                                                                             | 0.041                                                                            | 7590                                                                             | 0.031                                                                            | 7582                                                                             | 0.031                                                                            | 7105                                                                             | 0.042                                                                            | 7545                                                                             | 0.033                                                                            | 7503                                                                             | 0.033                                                                            |
| 50                                                                               | 6421                                                                             | 0.063                                                                            | 6804                                                                             | 0.050                                                                            | 6830                                                                             | 0.049                                                                            | 6394                                                                             | 0.065                                                                            | 6724                                                                             | 0.054                                                                            | 6758                                                                             | 0.053                                                                            |
| AVG                                                                              | 7232.3                                                                           | 0.042                                                                            | 7617.0                                                                           | 0.033                                                                            | 7617.0                                                                           | 0.032                                                                            | 7198.8                                                                           | 0.043                                                                            | 7545.3                                                                           | 0.035                                                                            | 7554.5                                                                           | 0.034                                                                            |

## D Detailed Experimental Results - Set X

Finally, Table 6 and Figures 8-9 provide the same detailed results for the X instance set of (Uchoa et al. 2017).

Figure 6: Convergence plots on set XML for all GNN configurations (for each configuration, left graph = complete run, right graph = last 1.5 seconds of the run time)

![Image](image_000007_6636d0bd5c4e4772a1c3207df6c789557b2eda78b7860b8b297b705a7a48bf1a.png)

Figure 7: Boxplots of the percentage error gaps achieved by the methods, for different subsets of the XML instances, using Γ = 15 and the ORIGINAL configuration of the GNN

![Image](image_000008_a3cfd0125d699f5c93a3c733554c688688b81c90915cd273f9be246e27cc2835.png)

![Image](image_000009_2fef482fcfbcace982cc76c02ec7fa47b8e2c881f7edb4757bc6e75f80dbd5af.png)

![Image](image_000010_0829b8af84197e5932c1d76d1ffc8dbbf9ebdaa034ff778741faba6ddf507076.png)

![Image](image_000011_beb0051cba0babdbc1e48a0a63a77308896be6e326c85cb4dc7aebedf52fa25d.png)

Table 6: Results for set X for all values of Γ ∈ { 15 20 30 50 , , , }

|                                                                                   | HGS-D-O                                                                           | HGS-D-O                                                                           | HGS-D-D                                                                           | HGS-D-D                                                                           | HGS-D-N                                                                           | HGS-D-N                                                                           | HGS-N-O                                                                           | HGS-N-O                                                                           | HGS-N-D                                                                           | HGS-N-D                                                                           | HGS-N-N                                                                           | HGS-N-N                                                                           |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| GNN                                                                               | #OPT                                                                              | GAP%                                                                              | #OPT                                                                              | GAP%                                                                              | #OPT                                                                              | GAP%                                                                              | #OPT                                                                              | GAP%                                                                              | #OPT                                                                              | GAP%                                                                              | #OPT                                                                              | GAP%                                                                              |
| ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     | ORIGINAL (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = 15.2%)     |
| 15                                                                                | 188                                                                               | 0.368                                                                             | 187                                                                               | 0.302                                                                             | 184                                                                               | 0.317                                                                             | 177                                                                               | 0.395                                                                             | 169                                                                               | 0.325                                                                             | 172                                                                               | 0.317                                                                             |
| 20                                                                                | 166                                                                               | 0.380                                                                             | 186                                                                               | 0.305                                                                             | 184                                                                               | 0.323                                                                             | 160                                                                               | 0.412                                                                             | 169                                                                               | 0.328                                                                             | 175                                                                               | 0.322                                                                             |
| 30                                                                                | 162                                                                               | 0.401                                                                             | 176                                                                               | 0.318                                                                             | 164                                                                               | 0.341                                                                             | 139                                                                               | 0.438                                                                             | 173                                                                               | 0.355                                                                             | 160                                                                               | 0.348                                                                             |
| 50                                                                                | 130                                                                               | 0.464                                                                             | 158                                                                               | 0.370                                                                             | 140                                                                               | 0.402                                                                             | 114                                                                               | 0.522                                                                             | 146                                                                               | 0.410                                                                             | 134                                                                               | 0.411                                                                             |
| AVG                                                                               | 161.5                                                                             | 0.403                                                                             | 176.8                                                                             | 0.324                                                                             | 168.0                                                                             | 0.346                                                                             | 147.5                                                                             | 0.442                                                                             | 164.3                                                                             | 0.354                                                                             | 160.3                                                                             | 0.350                                                                             |
| OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) | OPTIMISTIC (#NODES: 300; #HIDDEN LAYERS: 100; #EPOCHS: 1500; PRED-T(S) = IGNORED) |
| 15                                                                                | 188                                                                               | 0.368                                                                             | 187                                                                               | 0.302                                                                             | 187                                                                               | 0.299                                                                             | 185                                                                               | 0.365                                                                             | 177                                                                               | 0.307                                                                             | 182                                                                               | 0.299                                                                             |
| 20                                                                                | 166                                                                               | 0.380                                                                             | 186                                                                               | 0.305                                                                             | 191                                                                               | 0.306                                                                             | 170                                                                               | 0.383                                                                             | 176                                                                               | 0.308                                                                             | 179                                                                               | 0.305                                                                             |
| 30                                                                                | 162                                                                               | 0.401                                                                             | 176                                                                               | 0.318                                                                             | 171                                                                               | 0.320                                                                             | 153                                                                               | 0.406                                                                             | 176                                                                               | 0.331                                                                             | 167                                                                               | 0.326                                                                             |
| 50                                                                                | 130                                                                               | 0.464                                                                             | 158                                                                               | 0.370                                                                             | 153                                                                               | 0.372                                                                             | 122                                                                               | 0.482                                                                             | 154                                                                               | 0.380                                                                             | 142                                                                               | 0.382                                                                             |
| AVG                                                                               | 161.5                                                                             | 0.403                                                                             | 176.8                                                                             | 0.324                                                                             | 175.5                                                                             | 0.324                                                                             | 157.5                                                                             | 0.409                                                                             | 170.8                                                                             | 0.332                                                                             | 167.5                                                                             | 0.328                                                                             |
| MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          | MODEL #1 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 500; PRED-T(S) = 1.9%)          |
| 15                                                                                | 188                                                                               | 0.368                                                                             | 187                                                                               | 0.302                                                                             | 185                                                                               | 0.309                                                                             | 166                                                                               | 0.414                                                                             | 177                                                                               | 0.332                                                                             | 184                                                                               | 0.336                                                                             |
| 20                                                                                | 166                                                                               | 0.380                                                                             | 186                                                                               | 0.305                                                                             | 172                                                                               | 0.312                                                                             | 165                                                                               | 0.419                                                                             | 177                                                                               | 0.337                                                                             | 179                                                                               | 0.340                                                                             |
| 30                                                                                | 162                                                                               | 0.401                                                                             | 176                                                                               | 0.318                                                                             | 181                                                                               | 0.322                                                                             | 149                                                                               | 0.445                                                                             | 170                                                                               | 0.355                                                                             | 164                                                                               | 0.350                                                                             |
| 50                                                                                | 130                                                                               | 0.464                                                                             | 158                                                                               | 0.370                                                                             | 143                                                                               | 0.373                                                                             | 120                                                                               | 0.500                                                                             | 149                                                                               | 0.391                                                                             | 143                                                                               | 0.400                                                                             |
| AVG                                                                               | 161.5                                                                             | 0.403                                                                             | 176.8                                                                             | 0.324                                                                             | 170.3                                                                             | 0.329                                                                             | 150.0                                                                             | 0.445                                                                             | 168.3                                                                             | 0.354                                                                             | 167.5                                                                             | 0.357                                                                             |
| MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         | MODEL #2 (#NODES: 10; #HIDDEN LAYERS: 5; #EPOCHS: 1500; PRED-T(S) = 1.9%)         |
| 15                                                                                | 188                                                                               | 0.368                                                                             | 187                                                                               | 0.302                                                                             | 186                                                                               | 0.301                                                                             | 169                                                                               | 0.391                                                                             | 175                                                                               | 0.314                                                                             | 170                                                                               | 0.316                                                                             |
| 20                                                                                | 166                                                                               | 0.380                                                                             | 186                                                                               | 0.305                                                                             | 179                                                                               | 0.310                                                                             | 162                                                                               | 0.394                                                                             | 183                                                                               | 0.321                                                                             | 177                                                                               | 0.322                                                                             |
| 30                                                                                | 162                                                                               | 0.401                                                                             | 176                                                                               | 0.318                                                                             | 174                                                                               | 0.322                                                                             | 164                                                                               | 0.429                                                                             | 162                                                                               | 0.335                                                                             | 174                                                                               | 0.340                                                                             |
| 50                                                                                | 130                                                                               | 0.464                                                                             | 158                                                                               | 0.370                                                                             | 155                                                                               | 0.371                                                                             | 127                                                                               | 0.478                                                                             | 150                                                                               | 0.388                                                                             | 146                                                                               | 0.389                                                                             |
| AVG                                                                               | 161.5                                                                             | 0.403                                                                             | 176.8                                                                             | 0.324                                                                             | 173.5                                                                             | 0.326                                                                             | 155.5                                                                             | 0.423                                                                             | 167.5                                                                             | 0.340                                                                             | 166.8                                                                             | 0.342                                                                             |

Figure 8: Convergence plots on set X for all GNN configurations (for each configuration, left graph = complete run, right graph = last 25 % of the run time)

![Image](image_000012_895cbd2c49c64ea2158506d1288a7bd3637b8318560f26c8b15a11c17adadc0a.png)

![Image](image_000013_a8f30f051310de6992bb3d318e27303787647df8756c64429af8d32233cbfec0.png)

![Image](image_000014_003e675b7eaf10962a088ffab703fce7eb55ae60cc998b759191efbdb9348d57.png)

Impact of the customers distributions

Figure 9: Boxplots of the percentage error gaps achieved by the methods, for different subsets of the X instances, using Γ = 15 and the ORIGINAL configuration of the GNN

![Image](image_000015_5f1e98d1e939e0864f2ff1c9ddd606b54b9893b5bfd2225b0aaae54aaf8278a1.png)

![Image](image_000016_cb5e2cc66cd9244d435175a7ab441ed08903499f41d9e593d9df42ea54c9a867.png)