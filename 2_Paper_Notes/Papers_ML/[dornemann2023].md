# Solving the capacitated vehicle routing problem with time windows via graph convolutional network assisted tree search and quantum-inspired computing

## Metadata
- **Link to PDF**: [[[dornemann2023] Solving the capacitated vehicle routing problem with time windows via graph convolutional network assisted tree search and quantum-inspired computing.pdf]]
- **Tags**: 
  #ML-Supervised 
  #ML-SupervisedFromOptimal 
  #GraphNeuralNetworks 
  #NeuralCombinatorialOptimization 
  #BeamSearch 
  #ML-AssistedHeuristics 
  #QuantumComputingVRP 
  #CVRPTW 
  #TimeWindowConstraints 
  #DeterministicVRP
- **Relevant**: true  
- **Reasoning**: Paper addresses a deterministic CVRPTW, employs a supervised GCN approach, and compares with classical methods — directly relevant.
- **Fit Score**: 10
- **State of the Art (SoA) Concepts**:
  - Graph Convolutional Networks (GCN)
  - Beam search heuristic for VRPTW
  - Quantum-inspired (QUBO) formulation for routing
  - Integration of ML predictions with an OR-based solver approach
  - Use of Solomon benchmarks
- **Performance Evaluation**: yes
- **Performance Evaluation Framework**: Solomon R201-based data generation, also standard Solomon benchmark set

## Abstract
"Vehicle routing problems are a class of NP-hard combinatorial optimization problems which attract a lot of attention, as they have many practical applications. In recent years there have been new developments solving vehicle routing problems with the help of machine learning, since learning how to automatically solve optimization problems has the potential to provide a big leap in optimization technology. Prior work on solving vehicle routing problems using machine learning has mainly focused on auto-regressive models, which are connected to high computational costs when combined with classical exact search methods as the model has to be evaluated in every search step. This paper proposes a new method for approximately solving the capacitated vehicle routing problem with time windows (CVRPTW) via a supervised deep learning-based approach in a non-autoregressive manner. The model uses a deep neural network to assist finding solutions by providing a probability distribution which is used to guide a tree search, resulting in a machine learning assisted heuristic. The model is built upon a new neural network architecture, called graph convolutional network, which is particularly suited for deep learning tasks. Furthermore, a new formulation for the CVRPTW in form of a quadratic unconstrained binary optimization (QUBO) problem is presented and solved via quantum-inspired computing in cooperation with Fujitsu, where a learned problem reduction based upon the proposed neural network is applied to circumvent limitations concerning the usage of quantumcomputing for large problem instances. Computational results show that the proposed models perform very well on small and medium sized instances compared to state-of-the-art solution methods in terms of computational costs and solution quality, and outperform commercial solvers for large instances."

## Summary
- **Problem & Motivation**
  - Focuses on the Capacitated Vehicle Routing Problem with Time Windows (CVRPTW), a deterministic, NP-hard problem with numerous logistical and supply chain applications.
  - Aims to leverage deep learning, particularly Graph Convolutional Networks (GCN), to generate partial solutions (edge probabilities) and guide a tree search or a quantum-inspired solver.

- **Core Contributions**
  - **Constructive Heuristic**: Proposes a supervised, non-autoregressive learning framework. A GCN predicts a probability distribution over edges for the CVRPTW. Beam search (limited-width breadth-first search) then constructs full routes using these probabilities.
  - **Quantum-Inspired Approach**: Presents a new QUBO formulation of the CVRPTW. Uses Fujitsu’s Digital Annealer (a specialized quantum-inspired device) to solve reduced-size problem instances. The GCN guides a learned problem reduction (filters out low-probability edges) before passing a smaller QUBO to the Digital Annealer.
  - **Computational Benchmarks**: Thorough experiments compare the proposed methods (GCN + beam search, GCN + Digital Annealer) against classical algorithms (LKH3, OR-Tools) and a commercial solver (Gurobi).

- **Methodology**
  1. **GCN Architecture**  
     - Adopts a Residual Gated Graph ConvNet which processes node features (coordinates, time window bounds, demands) and edge features (travel cost, indicator functions).  
     - Outputs a probability matrix indicating how likely each edge is part of a high-quality CVRPTW solution.
     - Trained via supervised learning, using solution labels generated by LKH3 (thus “from optimal or near-optimal solutions”).
  2. **Beam Search Construction**  
     - The probabilities from the GCN are used in a beam search.  
     - Invalid edges (due to capacity/time windows) are masked out during expansion.  
     - A beam width parameter controls the trade-off between solution quality and runtime.  
     - Proposes two variations:
       - **GCNBS**: Uses the highest-probability path as final solution.
       - **GCNBSSTH**: Explores multiple partial solutions, then picks the shortest feasible tour from the final beam.
  3. **QUBO Formulation + Digital Annealer**  
     - Derives a QUBO representation of the CVRPTW with capacity constraints, time windows, and route continuity.  
     - Because QUBO expansions can blow up in size (requiring many binary variables for integer/time modeling), a learned reduction filters edges below a probability threshold.  
     - The reduced problem is then sent to Fujitsu’s Digital Annealer, which solves the BQP (or QUBO) with specialized parallel tempering techniques.  
     - Integrates an automatic penalty scaling to enforce feasibility constraints.

- **Key Results**
  - On small and medium-sized instances (20-50 nodes), the GCN + Beam Search achieves near-LKH3 quality (within a few percentage points gap), outperforming Gurobi in both runtime and solutions found.  
  - On larger instances (100 nodes), performance remains respectable but not as strong as specialized heuristics like LKH3 or OR-Tools. The beam search complexity grows significantly, limiting practicality if the beam width is too large.  
  - The quantum-inspired approach (GCN + Digital Annealer) shows potential but struggles with the integer variables in the CVRPTW, leading to slower convergence and larger solution gaps. Learned reduction helps but not enough to beat strong heuristics for large instances.  
  - Overall, the approach demonstrates the feasibility of combining classical heuristics, GCN-based predictions, and quantum-inspired devices for a highly constrained VRP.

- **Strengths**
  - Integrates advanced GCN-based modeling to handle time windows and capacity constraints without heavy manual feature engineering.  
  - Demonstrates how to embed ML insights (probability-based edge filtering) into classical or specialized solvers (beam search, quantum-inspired).  
  - Validated on recognized benchmarks (Solomon), employing standard references like LKH3, OR-Tools, and Gurobi.

- **Weaknesses / Limitations**
  - Relies on supervised data, thus needs near-optimal solutions (from LKH3) for training. Could be costly to scale up if training data for larger instances is required.  
  - Beam search approach can explode in runtime with bigger beam widths, and the time-window masking step may become a bottleneck.  
  - The QUBO approach struggles with integer variables for large-scale CVRPTW. The overhead of binary expansions and penalty terms is high, limiting the Digital Annealer’s ability to surpass powerful heuristic solvers.

- **Relevance to Deterministic VRP Research**
  - Offers a supervised GCN-based methodology specifically for deterministic CVRPTW.  
  - Illustrates how quantum-inspired hardware might be combined with ML to tackle structured VRPs in future research.  
  - Provides insight into the trade-offs between purely learning-driven constructive heuristics and classical approaches for constrained VRPs.

- **Future Directions**
  - Improve the constructive approach by providing more contextual information when selecting the next node (e.g., partial tours).  
  - Investigate reinforcement or iterative improvement to reduce reliance on fully supervised data.  
  - Refine QUBO modeling to handle integer variables more efficiently or look for specialized hybrid methods bridging quantum-inspired and classical algorithms.  
  - Explore generalizing the model beyond the specific R201 distribution of Solomon’s dataset.

